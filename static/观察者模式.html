<html>
  <head>
    <meta charset="utf-8" />
    <title>观察者模式</title>
  </head>
  <body>
    <h2>观察者模式</h2>
  </body>
  <script>
    class Subject {
      constructor() {
        this.observers = []; // 订阅者列表
      }
      // 订阅
      subscribe(observer) {
        this.observers.push(observer);
      }
      // 取消订阅
      unsubscribe(observer) {
        const index = this.observers.indexOf(observer);
        if (index > -1) {
          this.observers.splice(index, 1);
        }
      }
      // 通知
      notify(data) {
        this.observers.forEach(observer=> observer.received(data))
      }
    }
    // 观察者
    class Observer {
      constructor(name) {
        this.name = name;
      }
      received(data) {
        console.log("The observer", this.name, "received data: ", data);
      }
    }
    let observer1 = new Observer('john');
    let observer2 = new Observer('alex');
    let subject = new Subject();
    subject.subscribe(observer1);
    subject.subscribe(observer2);
    subject.notify('让我观察一下');
    // The observer john received data:  让我观察一下
    // The observer alex received data:  让我观察一下
  </script>
  <style></style>
</html>
